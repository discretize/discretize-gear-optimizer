"use strict";const Optimizer=function(h){var e=Object.freeze({GEAR_OPTIMIZER:"#go-",CHECKBOX:"checkbox-",INPUT:"input-",SELECT:"select-"});const l=Object.freeze({TOTAL:"#gear-optimizer",CHECKBOX:{AFFIX:{BERSERKER:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-berserker",ASSASSIN:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-assassin",COMMANDER:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-commander",HARRIER:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-harrier",DIVINER:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-diviner",VIPER:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-viper",GRIEVING:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-grieving",SINISTER:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-sinister",MINSTREL:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-minstrel",MAGI:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-magi",SERAPH:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-seraph",CELESTIAL:e.GEAR_OPTIMIZER+e.CHECKBOX+"affix-celestial"},BUFF:{MIGHT:e.GEAR_OPTIMIZER+e.CHECKBOX+"buff-might",FURY:e.GEAR_OPTIMIZER+e.CHECKBOX+"buff-fury",VULNERABILITY:e.GEAR_OPTIMIZER+e.CHECKBOX+"condition-vulnerability",BANNER_OF_STRENGTH:e.GEAR_OPTIMIZER+e.CHECKBOX+"buff-banner-of-strength",BANNER_OF_DISCIPLINE:e.GEAR_OPTIMIZER+e.CHECKBOX+"buff-banner-of-discipline",EMPOWER_ALLIES:e.GEAR_OPTIMIZER+e.CHECKBOX+"buff-empower-allies",BANE_SIGNET:e.GEAR_OPTIMIZER+e.CHECKBOX+"buff-bane-signet",SPOTTER:e.GEAR_OPTIMIZER+e.CHECKBOX+"buff-spotter",FROST_SPIRIT:e.GEAR_OPTIMIZER+e.CHECKBOX+"buff-frost-spirit",ASSASSINS_PRESENCE:e.GEAR_OPTIMIZER+e.CHECKBOX+"buff-assassins-presence"},OMNIPOTION:e.GEAR_OPTIMIZER+e.CHECKBOX+"omnipotion"},CHECKBOXES:'input[type="checkbox"]',CHECKBOXES_CHECKED:'input[type="checkbox"]:checked',INPUT:{OPTIMIZER:e.GEAR_OPTIMIZER+"input",CLASS:e.GEAR_OPTIMIZER+e.INPUT+"class",TAB_PANE_ACTIVE:".tab-pane.active",AFFIXES:e.GEAR_OPTIMIZER+e.INPUT+"affixes",BUFFS:e.GEAR_OPTIMIZER+e.INPUT+"buffs",MIN_BOON_DURATION:e.GEAR_OPTIMIZER+e.INPUT+"min-boon-duration",MIN_TOUGHNESS:e.GEAR_OPTIMIZER+e.INPUT+"min-toughness",MIN_HEALING_POWER:e.GEAR_OPTIMIZER+e.INPUT+"min-healing-power",MAX_TOUGHNESS:e.GEAR_OPTIMIZER+e.INPUT+"max-toughness",AGONY_RESISTANCE:e.GEAR_OPTIMIZER+e.INPUT+"agony-resistance",MAX_RESULTS:e.GEAR_OPTIMIZER+e.INPUT+"max-results"},SELECT:{RANKBY:e.GEAR_OPTIMIZER+e.SELECT+"rank-by",WEAPON_TYPE:e.GEAR_OPTIMIZER+e.SELECT+"weapon-type",RUNES:e.GEAR_OPTIMIZER+e.SELECT+"runes",SIGIL_1:e.GEAR_OPTIMIZER+e.SELECT+"sigil-1",SIGIL_2:e.GEAR_OPTIMIZER+e.SELECT+"sigil-2",FOOD:e.GEAR_OPTIMIZER+e.SELECT+"food",UTILITY:e.GEAR_OPTIMIZER+e.SELECT+"utility",INFUSIONS:e.GEAR_OPTIMIZER+e.SELECT+"infusions"},OUTPUT:{LIST:e.GEAR_OPTIMIZER+"output",PROGRESS_BAR:e.GEAR_OPTIMIZER+"progress-bar",HEADER:e.GEAR_OPTIMIZER+"output-header"},LABEL:"label",SPAN:"span",DROPDOWN_SELECT:".dropdown-select",DROPDOWN_TOGGLE:".dropdown-toggle",DROPDOWN_MENU:".dropdown-menu",DROPDOWN_ITEM:".dropdown-item",START:"button"+e.GEAR_OPTIMIZER+"start",STOP:"button"+e.GEAR_OPTIMIZER+"stop"}),n=Object.freeze({ACTIVE:"active",DISABLED:"disabled"}),c=Object.freeze({CHECKED:"checked",DISABLED:"disabled"}),E=Object.freeze({PRIORITIES:"go-priorities",BUFFS:"go-buffs",MODIFIER:"go-modifier",CLASS:"go-class",PRESELECTION:"go-preselection",DISTRIBUTION:"go-distribution"});let u=!1;const m=Object.freeze({PRIMARY:["Power","Precision","Toughness","Vitality"],SECONDARY:["Ferocity","Condition Damage","Expertise","Concentration","Healing Power","Agony Resistance"],DERIVED:["Critical Chance","Critical Damage","Condition Duration","Boon Duration","Health","Armor"],BOON_DURATION:["Aegis Duration","Fury Duration","Might Duration","Protection Duration","Quickness Duration","Regeneration Duration","Resistance Duration","Retaliation Duration","Stability Duration","Swiftness Duration","Vigor Duration"],CONDITION_DURATION:["Bleeding Duration","Blind Duration","Burning Duration","Chilled Duration","Confusion Duration","Crippled Duration","Fear Duration","Immobile Duration","Poison Duration","Slow Duration","Taunt Duration","Torment Duration","Vulnerability Duration","Weakness Duration"],EFFECTIVE:["Effective Power","Effective Health","Effective Healing"],CONDITION_DAMAGE:["Bleeding Damage","Burning Damage","Confusion Damage","Poison Damage","Torment Damage"],INDICATORS:["Damage","Survivability","Healing"]}),g=Object.freeze({Berserker:{type:"triple",bonuses:{major:["Power"],minor:["Precision","Ferocity"]}},Assassin:{type:"triple",bonuses:{major:["Precision"],minor:["Power","Ferocity"]}},Harrier:{type:"triple",bonuses:{major:["Power"],minor:["Concentration","Healing Power"]}},Commander:{type:"quadruple",bonuses:{major:["Power","Precision"],minor:["Toughness","Concentration"]}},Minstrel:{type:"quadruple",bonuses:{major:["Toughness","Healing Power"],minor:["Vitality","Concentration"]}},Magi:{type:"triple",bonuses:{major:["Healing Power"],minor:["Vitality","Precision"]}},Marauder:{type:"quadruple",bonuses:{major:["Power","Precision"],minor:["Vitality","Ferocity"]}},Cleric:{type:"triple",bonuses:{major:["Healing Power"],minor:["Power","Toughness"]}},Nomad:{type:"triple",bonuses:{major:["Toughness"],minor:["Vitality","Healing Power"]}},Zealot:{type:"triple",bonuses:{major:["Power"],minor:["Precision","Healing Power"]}},Viper:{type:"quadruple",bonuses:{major:["Power","Condition Damage"],minor:["Precision","Expertise"]}},Sinister:{type:"triple",bonuses:{major:["Condition Damage"],minor:["Power","Precision"]}},Grieving:{type:"quadruple",bonuses:{major:["Power","Condition Damage"],minor:["Precision","Ferocity"]}},Seraph:{type:"quadruple",bonuses:{major:["Precision","Condition Damage"],minor:["Healing Power","Concentration"]}},Marshal:{type:"quadruple",bonuses:{major:["Power","Healing Power"],minor:["Precision","Condition Damage"]}},Giver:{type:"triple",bonuses:{major:["Toughness"],minor:["Healing Power","Concentration"]}},Knight:{type:"triple",bonuses:{major:["Toughness"],minor:["Power","Precision"]}},Trailblazer:{type:"quadruple",bonuses:{major:["Toughness","Condition Damage"],minor:["Vitality","Expertise"]}},Plaguedoctor:{type:"quadruple",bonuses:{major:["Vitality","Condition Damage"],minor:["Healing Power","Concentration"]}},Carrion:{type:"triple",bonuses:{major:["Condition Damage"],minor:["Power","Vitality"]}},Rabid:{type:"triple",bonuses:{major:["Condition Damage"],minor:["Toughness","Precision"]}},Dire:{type:"triple",bonuses:{major:["Condition Damage"],minor:["Toughness","Vitality"]}},Vigilant:{type:"quadruple",bonuses:{major:["Power","Toughness"],minor:["Concentration","Expertise"]}},Valkyrie:{type:"triple",bonuses:{major:["Power"],minor:["Vitality","Ferocity"]}},Cavalier:{type:"triple",bonuses:{major:["Toughness"],minor:["Power","Ferocity"]}},"Berserker+Valkyrie":{type:"bervalk",bonuses:{major:["Power"],minor:["Vitality","Ferocity"]}},Celestial:{type:"celestial",bonuses:{major:["Power","Precision","Toughness","Vitality"],minor:["Ferocity","Condition Damage","Expertise","Concentration","Healing Power"]}},Diviner:{type:"quadruple",bonuses:{major:["Power","Concentration"],minor:["Precision","Ferocity"]}},Soldier:{type:"triple",bonuses:{major:["Power"],minor:["Toughness","Vitality"]}},Sentinel:{type:"triple",bonuses:{major:["Vitality"],minor:["Power","Toughness"]}},Wanderer:{type:"quadruple",bonuses:{major:["Power","Vitality"],minor:["Toughness","Concentration"]}},Apothecary:{type:"triple",bonuses:{major:["Healing Power"],minor:["Condition Damage","Toughness"]}},Shaman:{type:"triple",bonuses:{major:["Vitality"],minor:["Condition Damage","Healing Power"]}},Crusader:{type:"quadruple",bonuses:{major:["Power","Toughness"],minor:["Ferocity","Healing Power"]}},Rampager:{type:"triple",bonuses:{major:["Precision"],minor:["Condition Damage","Power"]}},Settler:{type:"triple",bonuses:{major:["Toughness"],minor:["Condition Damage","Healing Power"]}},Bringer:{type:"triple",bonuses:{major:["Expertise"],minor:["Precision","Vitality"]}}});var o=Object.freeze({HELM:{triple:{major:63,minor:45},quadruple:{major:54,minor:30},celestial:{major:30,minor:30}},SHOULDERS:{triple:{major:47,minor:34},quadruple:{major:40,minor:22},celestial:{major:22,minor:22}},CHEST:{triple:{major:141,minor:101},quadruple:{major:121,minor:67},celestial:{major:67,minor:67}},GLOVES:{triple:{major:47,minor:34},quadruple:{major:40,minor:22},celestial:{major:22,minor:22}},LEGGINGS:{triple:{major:94,minor:67},quadruple:{major:81,minor:44},celestial:{major:44,minor:44}},BOOTS:{triple:{major:47,minor:34},quadruple:{major:40,minor:22},celestial:{major:22,minor:22}},AMULET:{triple:{major:157,minor:108},quadruple:{major:133,minor:71},celestial:{major:72,minor:72}},RING:{triple:{major:126,minor:85},quadruple:{major:106,minor:56},celestial:{major:57,minor:57}},ACCESSORY:{triple:{major:110,minor:74},quadruple:{major:92,minor:49},celestial:{major:50,minor:50}},BACK_ITEM:{triple:{major:63,minor:40},quadruple:{major:52,minor:27},celestial:{major:28,minor:28}},ONEHANDED_WEAPON:{triple:{major:125,minor:90},quadruple:{major:108,minor:59},celestial:{major:59,minor:59}},TWOHANDED_WEAPON:{triple:{major:251,minor:179},quadruple:{major:215,minor:118},celestial:{major:118,minor:118}}});const D=Object.freeze({"Dual wield":[{name:"Helm",short:"Helm",item:o.HELM},{name:"Shoulders",short:"Shld",item:o.SHOULDERS},{name:"Coat",short:"Coat",item:o.CHEST},{name:"Gloves",short:"Glov",item:o.GLOVES},{name:"Leggings",short:"Legs",item:o.LEGGINGS},{name:"Boots",short:"Boot",item:o.BOOTS},{name:"Amulet",short:"Amul",item:o.AMULET},{name:"Ring 1",short:"Rng1",item:o.RING},{name:"Ring 2",short:"Rng2",item:o.RING},{name:"Accessory 1",short:"Acc1",item:o.ACCESSORY},{name:"Accessory 2",short:"Acc2",item:o.ACCESSORY},{name:"Back Item",short:"Back",item:o.BACK_ITEM},{name:"Mainhand",short:"Wep1",item:o.ONEHANDED_WEAPON},{name:"Offhand",short:"Wep2",item:o.ONEHANDED_WEAPON}],"Two-handed":[{name:"Helm",short:"Helm",item:o.HELM},{name:"Shoulders",short:"Shld",item:o.SHOULDERS},{name:"Coat",short:"Coat",item:o.CHEST},{name:"Gloves",short:"Glov",item:o.GLOVES},{name:"Leggings",short:"Legs",item:o.LEGGINGS},{name:"Boots",short:"Boot",item:o.BOOTS},{name:"Amulet",short:"Amul",item:o.AMULET},{name:"Ring 1",short:"Rng1",item:o.RING},{name:"Ring 2",short:"Rng2",item:o.RING},{name:"Accessory 1",short:"Acc1",item:o.ACCESSORY},{name:"Accessory 2",short:"Acc2",item:o.ACCESSORY},{name:"Back Item",short:"Back",item:o.BACK_ITEM},{name:"Weapon",short:"Weap",item:o.TWOHANDED_WEAPON}]}),p=Object.freeze({multiplier:{"Effective Power":.15,"add: Effective Condition Damage":.15,"Effective Health":.25},convert:{Precision:{"Agony Resistance":1.5},Toughness:{"Agony Resistance":1.5},Concentration:{"Agony Resistance":1.5},"Condition Damage":{"Condition Damage":.15}}});e=Object.freeze({LOW:1645,MEDIUM:5922,HIGH:9212}),o=Object.freeze({LIGHT:967,MEDIUM:1118,HEAVY:1271});const C=Object.freeze({warrior:{health:e.HIGH,defense:o.HEAVY},necromancer:{health:e.HIGH,defense:o.LIGHT},revenant:{health:e.MEDIUM,defense:o.HEAVY},engineer:{health:e.MEDIUM,defense:o.MEDIUM},ranger:{health:e.MEDIUM,defense:o.MEDIUM},mesmer:{health:e.MEDIUM,defense:o.LIGHT},guardian:{health:e.LOW,defense:o.HEAVY},thief:{health:e.LOW,defense:o.MEDIUM},elementalist:{health:e.LOW,defense:o.LIGHT}}),f=Object.freeze({Burning:{baseDamage:131,factor:.155},Bleeding:{baseDamage:22,factor:.06},Poison:{baseDamage:33.5,factor:.06},Torment:{baseDamage:31.8,factor:.09},Confusion:{baseDamage:22,factor:.06}}),d=90,t=function(){function e(){var e=this;e.startTime=new Date;const t=[],r=[];h.each(h([l.INPUT.CLASS+" "+l.INPUT.TAB_PANE_ACTIVE,l.INPUT.BUFFS].join(",")).find(l.CHECKBOXES_CHECKED+"[data-"+E.MODIFIER+"]"),function(){t.push(h(this).data(E.MODIFIER));const e=h(this).siblings(l.LABEL).children(l.SPAN);if(e.is("[data-armory-ids]")){const o=e.children("div").attr("class").split(" ")[1];r.push('<div data-armory-size="40" data-armory-embed="'+o.substring(5,o.length-6)+'" data-armory-ids="'+e.data("armory-ids")+'"></div>')}else e.hasClass("icon")&&r.push('<div class="icon icon-lg '+e.attr("class").split(" ")[1]+'"></div>')}),h.each(h([l.SELECT.RUNES,l.SELECT.SIGIL_1,l.SELECT.SIGIL_2,l.SELECT.FOOD,l.SELECT.UTILITY].join(",")).children(l.DROPDOWN_MENU).children(l.DROPDOWN_ITEM+"."+n.ACTIVE+"[data-"+E.MODIFIER+"]"),function(){t.push(h(this).data(E.MODIFIER)),r.push('<div data-armory-size="40" data-armory-embed="items" data-armory-ids="'+h(this).children(l.SPAN).data("armory-ids")+'"></div>')}),h(l.CHECKBOX.OMNIPOTION).prop(c.CHECKED)&&(t.push(p),r.push('<div data-armory-size="40" data-armory-embed="items" data-armory-ids="79722"></div>')),t.push({flat:{"Agony Resistance":parseInt(h(l.INPUT.AGONY_RESISTANCE).val())}}),e.settings={};const{settings:i}=e;i.profession=h(l.TOTAL).find("a.nav-link[data-"+E.CLASS+"]."+n.ACTIVE).data(E.CLASS),i.weapontype=h(l.SELECT.WEAPON_TYPE).children(l.DROPDOWN_MENU).children(l.DROPDOWN_ITEM+"."+n.ACTIVE).text().trim(),i.baseAttributes={},i.baseAttributes.Health=C[i.profession].health,i.baseAttributes.Armor=C[i.profession].defense;for(const o of m.PRIMARY)i.baseAttributes[o]=1e3;for(const a of m.SECONDARY)i.baseAttributes[a]=0;i.baseAttributes["Condition Duration"]=0,i.baseAttributes["Boon Duration"]=0,i.baseAttributes["Critical Chance"]=5,i.baseAttributes["Critical Damage"]=150;if(h.each(t,function(e,o){(o=o)&&(i.modifiers||(i.modifiers={}),h.each(o,function(r,o){r&&void 0!==o&&(i.modifiers[r]||(i.modifiers[r]={}),r&&("bountiful-maintenance-oil"===r?i.modifiers[r]=o:h.each(o,function(t,e){if(t&&e)switch(r){case"multiplier":if("Effective Condition Damage"!==t&&"Critical Damage"!==t&&!m.EFFECTIVE.includes(t)&&!m.CONDITION_DAMAGE.includes(t)&&"add: Effective Condition Damage"!==t&&"add: Effective Power"!==t)throw console.error(o),"Multipliers can only modify primary, secondary oreffective attributes, not "+t;i.modifiers[r][t]?t.startsWith("add: ")?i.modifiers[r][t][0]+=e:i.modifiers[r][t][0]=(i.modifiers[r][t][0]+1)*(e+1)-1:(i.modifiers[r][t]=[],i.modifiers[r][t].push(e));break;case"flat":case"buff":if(!(m.PRIMARY.includes(t)||m.SECONDARY.includes(t)||m.DERIVED.includes(t)||m.BOON_DURATION.includes(t)||m.CONDITION_DURATION.includes(t)))throw console.error(o),"Flat or buff modifiers can only increase primary, secondary orderived attributes, not "+t;i.modifiers[r][t]=(i.modifiers[r][t]||0)+e;break;case"convert":if(!m.PRIMARY.includes(t)&&!m.SECONDARY.includes(t))throw console.error(o),"Conversions can only modify primary or secondary attributes, not "+t;i.modifiers[r][t]||(i.modifiers[r][t]={}),h.each(e,function(e,o){i.modifiers[r][t][e]=(i.modifiers[r][t][e]||0)+o})}})))}))}),i.tags=r,i.affixes=h(l.INPUT.AFFIXES).find(l.CHECKBOXES_CHECKED).map(function(){return h(this).siblings(l.LABEL).text().trim()}).get(),i.rankby=h(l.SELECT.RANKBY).children(l.DROPDOWN_MENU).children(l.DROPDOWN_ITEM+"."+n.ACTIVE).text().trim(),i.minBoonDuration=parseFloat(h(l.INPUT.MIN_BOON_DURATION).val()),i.minHealingPower=parseInt(h(l.INPUT.MIN_HEALING_POWER).val()),i.minToughness=parseInt(h(l.INPUT.MIN_TOUGHNESS).val()),i.maxToughness=parseInt(h(l.INPUT.MAX_TOUGHNESS).val()),i.maxResults=parseInt(h(l.INPUT.MAX_RESULTS).val()),i.statInfusions=h(l.SELECT.INFUSIONS).children(l.DROPDOWN_MENU).children(l.DROPDOWN_ITEM+"."+n.ACTIVE).text().trim(),"None"!==i.statInfusions){if(i.primaryInfusion=i.statInfusions.split("+")[0].trim(),i.secondaryInfusion=-1!==i.statInfusions.indexOf("+")?i.statInfusions.split("+")[1].trim():null,!(m.PRIMARY.includes(i.primaryInfusion)||m.SECONDARY.includes(i.primaryInfusion)||m.DERIVED.includes(i.primaryInfusion)||m.BOON_DURATION.includes(i.primaryInfusion)||m.CONDITION_DURATION.includes(i.primaryInfusion)))throw"Infusions can only increase primary, secondary or derived attributes, not "+i.primaryInfusion;if(i.secondaryInfusion&&!m.PRIMARY.includes(i.secondaryInfusion)&&!m.SECONDARY.includes(i.secondaryInfusion)&&!m.DERIVED.includes(i.secondaryInfusion)&&!m.BOON_DURATION.includes(i.secondaryInfusion)&&!m.CONDITION_DURATION.includes(i.secondaryInfusion))throw"Infusions can only increase primary, secondary or derived attributes, not "+i.secondaryInfusion}i.distribution={},i.relevantConditions=[],h.each(h("#go-condition-distribution-input").find("input[data-go-distribution]"),function(){var e=parseInt(h(this).val());e&&(i.distribution[h(this).data("go-distribution")]=e,"Power"!==h(this).data("go-distribution")&&i.relevantConditions.push(h(this).data("go-distribution")))}),Object.freeze(e.settings)}e.prototype.calculate=function(){var e=this;const{settings:o}=e;var t="Dual wield"===o.weapontype?5:6,r="Dual wield"===o.weapontype?3:2;e.calculationTotal=Math.pow(o.affixes.length,t)*Math.pow(o.affixes.length+e._choose(o.affixes.length,2),r)*(o.affixes.length+o.affixes.length*(o.affixes.length-1)+e._choose(o.affixes.length,3)),u=!1,e.calculationRuns=0,e.list=h(l.OUTPUT.LIST),e.list.empty(),h(l.OUTPUT.PROGRESS_BAR).closest("td").attr("colspan",D[o.weapontype].length+1+!!o.primaryInfusion+!!o.secondaryInfusion),h(l.OUTPUT.PROGRESS_BAR).css("width","0%").children(l.SPAN).text("0%"),h(l.OUTPUT.PROGRESS_BAR).parent().show(),h(l.OUTPUT.HEADER).html("<th>"+o.rankby+"</th>"+h.map(D[o.weapontype],function(e){return'<th title="'+e.name+'">'+e.short+"</th>"}).join("")+(o.primaryInfusion?'<th title="'+o.primaryInfusion+'">'+o.primaryInfusion.substring(0,4)+"</th>":"")+(o.secondaryInfusion?'<th title="'+o.secondaryInfusion+'">'+o.secondaryInfusion.substring(0,4)+"</th>":"")),e._lock(!0),e.calculationQueue=[],e.calculationQueue.push([]),e.calculationStatsQueue=[],e.calculationStatsQueue.push({}),e.timer=e.startTime,setTimeout(e._advanceCalculation.bind(e),0)},e.prototype._lock=function(e){h("body").css("cursor",e?"progress":"default"),h(l.INPUT.OPTIMIZER).css("opacity",e?.5:1),h(l.INPUT.CLASS).css("opacity",e?.5:1),h(l.START).prop(c.DISABLED,e),h(l.START).find(".fa").toggleClass("fa-spin",e),h(l.STOP).prop(c.DISABLED,!e),e||(u?h(l.OUTPUT.PROGRESS_BAR).children("span").text("Cancelled after "+(new Date-this.startTime)+"ms ("+h(l.OUTPUT.PROGRESS_BAR).children("span").text()+")"):h(l.OUTPUT.PROGRESS_BAR).children("span").text("Completed in "+(new Date-this.startTime)+"ms"))},e.prototype._advanceCalculation=function(){var o,t,r=this,{settings:i}=r;try{let e=1e3;for(;r.calculationQueue.length&&e--;){if(u)throw 0;1===e&&new Date-r.timer<55&&(e=1e3);const n=r.calculationQueue.pop(),s=r.calculationStatsQueue.pop();var a=n.length;if(!((9===a||11===a||14===a)&&n[a-2]>n[a-1]||6===a&&(n[1]>n[3]||n[3]>n[5])))if(a>=D[i.weapontype].length)r.calculationRuns++,r._testCharacter(n,s);else{for(let e=1;e<i.affixes.length;e++){const E=n.slice(),p=Object.assign({},s),C=i.affixes[e];E[a]=C,h.each(D[i.weapontype][a].item[g[C].type],function(e,o){for(const t of g[C].bonuses[e])p[t]=(p[t]||0)+o}),r.calculationQueue.push(E),r.calculationStatsQueue.push(p)}const c=i.affixes[0];n[a]=c,h.each(D[i.weapontype][a].item[g[c].type],function(e,o){for(const t of g[c].bonuses[e])s[t]=(s[t]||0)+o}),r.calculationQueue.push(n),r.calculationStatsQueue.push(s)}}r.calculationQueue.length?(o=Math.floor(100*r.calculationRuns/r.calculationTotal),h(l.OUTPUT.PROGRESS_BAR).css("width",o+"%").find(l.SPAN).text(o+"%"),r.timer=new Date,setTimeout(r._advanceCalculation.bind(r),0)):(t=Math.floor(100*r.calculationRuns/r.calculationTotal),h(l.OUTPUT.PROGRESS_BAR).css("width",t+"%"),r._lock(!1))}catch(e){if(r._lock(!1),0!==e)throw e}},e.prototype._testCharacter=function(e,o){const t=this,{settings:r}=t;if(e){const a={gear:e,settings:t.settings,attributes:null,valid:!0,baseAttributes:Object.assign({},r.baseAttributes)};for(const n in o)a.baseAttributes[n]+=o[n];var i;r.primaryInfusion?r.secondaryInfusion?(!t.worstScore||(i=H(a),s(i,r.primaryInfusion,d),s(i,r.secondaryInfusion,d),I(i,!0),i.attributes[r.rankby]>t.worstScore))&&t._applySecondaryInfusions(a):(a.infusions={[r.primaryInfusion]:18},s(a,r.primaryInfusion,d),I(a),t._insertCharacter(a)):(I(a),t._insertCharacter(a))}},e.prototype._insertCharacter=function(o){var t=this,{settings:r}=t;if(o.valid&&!(t.worstScore&&t.worstScore>o.attributes[r.rankby]))if(0===t.list.children().length)t.list.append(t._characterToRow(o));else{let e=t.list.children().length+1;for(;1<e&&t._characterLT(t.list.children().eq(e-2).data("character"),o);)e--;e>r.maxResults||(e<=t.list.children().length?(t._characterToRow(o).insertBefore(t.list.children().eq(e-1)),t.list.children().length>r.maxResults&&t.list.children().last().remove()):t.list.append(t._characterToRow(o)),t.list.children().length===r.maxResults&&(t.worstScore=t.list.children().last().data("character").attributes[r.rankby]))}};const s=function(e,o,t){e.baseAttributes[o]=(e.baseAttributes[o]||0)+t};return e.prototype._applySecondaryInfusions=function(o){var{settings:t}=this;let r=null;for(let e=d;0<=e;e-=5){const i=H(o);s(i,t.primaryInfusion,e),s(i,t.secondaryInfusion,d-e),I(i),i.valid&&(i.infusions={[t.primaryInfusion]:e/5,[t.secondaryInfusion]:(d-e)/5},r&&!this._characterLT(r,i)||(r=i))}r&&this._insertCharacter(r)},e.prototype._characterToRow=function(e){var{settings:o}=e;return h("<tr><td><strong>"+Number(e.attributes[o.rankby].toFixed(2)).toLocaleString("en-US")+"</strong></td>"+h.map(e.gear,function(e){return"<td><samp>"+e.substring(0,4)+"</samp></td>"}).join("")+h.map(e.infusions,function(e){return"<td><samp>"+e+"</samp></td>"}).join("")+"</tr>").data("character",e)},e.prototype._characterLT=function(t,r){var{settings:e}=this;if(t.attributes[e.rankby]!==r.attributes[e.rankby])return t.attributes[e.rankby]<r.attributes[e.rankby];{let e=0,o=0;for(const i of m.PRIMARY.concat(m.SECONDARY))e+=t.attributes.hasOwnProperty(i)?t.attributes[i]:0,o+=r.attributes.hasOwnProperty(i)?r.attributes[i]:0;return e<o}},e.prototype._choose=function(o,t){let r=1,i=1;for(let e=0;e<t;e++)r*=o-e,i*=e+1;return r/i},e}(),I=function(i,e=!1){const{settings:o}=i;i.attributes=Object.assign({},i.baseAttributes),i.valid=!0,h.each(o.modifiers.flat,function(e,o){i.attributes[e]=(i.attributes[e]||0)+o});const r=Object.assign({},i.attributes);if((h.each(o.modifiers.convert,function(t,e){h.each(e,function(e,o){i.attributes[t]=(i.attributes[t]||0)+Math.round(r[e]*o)})}),h.each(o.modifiers.buff,function(e,o){i.attributes[e]=(i.attributes[e]||0)+o}),i.attributes["Boon Duration"]+=i.attributes.Concentration/15,!e)&&(o.minBoonDuration&&i.attributes["Boon Duration"]<o.minBoonDuration||o.minHealingPower&&i.attributes["Healing Power"]<o.minHealingPower||o.minToughness&&i.attributes.Toughness<o.minToughness||o.maxToughness&&i.attributes.Toughness>o.maxToughness))return i.valid=!1;i.attributes["Condition Duration"]+=i.attributes.Expertise/15,i.attributes["Critical Chance"]=(i.attributes.Precision-1e3)/21+i.attributes["Critical Chance"],i.attributes["Critical Damage"]+=i.attributes.Ferocity/15,i.attributes.Health+=10*i.attributes.Vitality,i.attributes.Armor+=i.attributes.Toughness;let t=i.attributes["Critical Damage"];if(t&&o.modifiers.multiplier&&o.modifiers.multiplier["Critical Damage"])for(const c of o.modifiers.multiplier["Critical Damage"])t*=1+c;i.attributes["Effective Power"]=i.attributes.Power+i.attributes.Power*Math.min(i.attributes["Critical Chance"]/100,1)*((t-100)/100),i.attributes["Effective Health"]=i.attributes.Health*i.attributes.Armor,i.attributes["Effective Healing"]=i.attributes["Healing Power"]||0;var a,n=o.modifiers.multiplier;!o.modifiers.hasOwnProperty("bountiful-maintenance-oil")||(a=.6*(i.attributes["Healing Power"]||0)/1e4+.8*(i.attributes.Concentration||0)/1e4)&&(i.attributes["Effective Healing"]*=1+a);let s=1;if(h.each(n,function(e,o){if(m.EFFECTIVE.includes(e)&&i.attributes[e])for(const t of o)i.attributes[e]*=1+t;else if("add: Effective Power"===e)for(const r of o)s+=r}),i.attributes["Effective Power"]*=s,e||o.relevantConditions.length){for(const E of e?Object.keys(f):o.relevantConditions)i.attributes[E+" Damage"]=f[E].factor*i.attributes["Condition Damage"]+f[E].baseDamage;if(n&&(n["Effective Condition Damage"]||n["add: Effective Condition Damage"])){if(n["add: Effective Condition Damage"]){let e=1;for(const p of n["add: Effective Condition Damage"])e+=p;for(const C of m.CONDITION_DAMAGE)i.attributes[C]*=e}if(n["Effective Condition Damage"])for(const l of n["Effective Condition Damage"])for(const u of m.CONDITION_DAMAGE)i.attributes[u]*=1+l}h.each(n,function(e,o){if(m.CONDITION_DAMAGE.includes(e)&&i.attributes[e])for(const t of o)i.attributes[e]*=1+t})}return i.attributes.Damage=0,h.each(o.distribution,function(e,o){var t;"Power"===e?i.attributes.Damage+=o*(i.attributes["Effective Power"]/1025):(t=1+Math.min(((i.attributes[e+" Duration"]||0)+i.attributes["Condition Duration"])/100,1),i.attributes.Damage+=o*t*(i.attributes[e+" Damage"]/f[e].baseDamage))}),i.attributes.Survivability=i.attributes["Effective Health"]/1967,i.attributes.Healing=i.attributes["Effective Healing"],!0},H=function(e){return{settings:e.settings,attributes:e.attributes,gear:e.gear,valid:e.valid,baseAttributes:Object.assign({},e.baseAttributes),infusions:Object.assign({},e.infusions)}},r=function(r){function e(e,o){let t='<div class="card card-'+r.settings.profession+' mb-3"><div class="card-header card-header-small">'+e+'</div><div class="card-body p-0"><table class="table table-sm table-hover">';return h.each(o,function(e,o){t+="<tr><th>"+e+"</th><td>"+o+"</td></tr>"}),t+="</table></div></div>",t}I(r,!0),console.debug(r);let o='<div class="modal">';o+='<div class="modal-dialog modal-lg">',o+='<div class="modal-content">',o+='<div class="modal-header">',o+='<h5 class="modal-title">Character Overview</h5>',o+='<button type="button" class="close" data-dismiss="modal"><span class="fa fa-times"></span></button>',o+="</div>",o+='<div class="modal-body">',o+='<div class="container-fluid">',o+='<div class="row">',o+='<div class="col-12 text-center"><div class="card card-'+r.settings.profession+' mb-3"><div class="card-header card-header-small">Modifiers</div><div class="card-body character-tags">'+r.settings.tags.join("")+"</div></div></div>",o+='<div class="col-12 col-lg-6">';const t={};h.each(m.INDICATORS,function(e,o){t[o]=Number(r.attributes[o].toFixed(4)).toLocaleString("en-US")}),o+=e("Indicators",t);const i={};if(h.each(r.gear,function(e,o){i[D[r.settings.weapontype][e].name]=o}),o+=e("Gear",i),o+=e("Stat Infusions",r.infusions),100!==r.settings.distribution.Power){const g={},d=r.attributes.Damage;h.each(r.settings.distribution,function(e,o){var t;"Power"===e?(t=o*r.attributes["Effective Power"]/1025,g.Power=(t/d*100).toFixed(1)+"%"):(o=o*(1+Math.min(((r.attributes[e+" Duration"]||0)+r.attributes["Condition Duration"])/100,1))*(r.attributes[e+" Damage"]/f[e].baseDamage),g[e+" Damage"]=(o/d*100).toFixed(1)+"%")}),o+=e("Effective Damage Distribution",g);const b={};h.each(r.settings.distribution,function(e,o){var t;"Power"===e?(t=o*r.attributes["Effective Power"]/1025,b.Power=Number(t).toFixed(2).toLocaleString("en-US")):(o=o*(1+Math.min(((r.attributes[e+" Duration"]||0)+r.attributes["Condition Duration"])/100,1))*(r.attributes[e+" Damage"]/f[e].baseDamage),b[e+" Damage"]=Number(o).toFixed(2).toLocaleString("en-US"))}),o+=e("Damage indicator breakdown",b)}const a={};h.each(["Power","Precision","Ferocity","Condition Damage","Expertise"],function(e,o){const t=H(r);t.baseAttributes[o]+=5,I(t,!0),a[o]=Number((t.attributes.Damage-r.attributes.Damage).toFixed(5)).toLocaleString("en-US")}),o+=e("Damage increase from +5 of attribute",a);const n={};h.each(["Power","Precision","Ferocity","Condition Damage","Expertise"],function(e,o){const t=H(r);t.baseAttributes[o]=Math.max(t.baseAttributes[o]-5,0),I(t,!0),n[o]=Number((t.attributes.Damage-r.attributes.Damage).toFixed(5)).toLocaleString("en-US")}),o+=e("Damage loss from -5 of attribute",n),o+="</div>",o+='<div class="col-12 col-lg-6">';const s={};h.each(m.PRIMARY,function(e,o){s[o]=r.attributes[o]||0}),o+=e("Primary Attributes",s);const c={};h.each(m.SECONDARY,function(e,o){c[o]=r.attributes[o]||0}),o+=e("Secondary Attributes",c);const E={};h.each(m.DERIVED,function(e,o){switch(o){case"Critical Chance":case"Boon Duration":case"Condition Duration":E[o]=100<r.attributes[o]?`100.00% (${r.attributes[o].toFixed(2)})`:`${r.attributes[o].toFixed(2)}%`;break;case"Critical Damage":E[o]=`${r.attributes[o].toFixed(2)}%`;break;default:E[o]=r.attributes[o]}}),o+=e("Derived Attributes",E);const p={};h.each(m.EFFECTIVE,function(e,o){const t=r.attributes[o]||0;p[o]=Number(t.toFixed(5)).toLocaleString("en-US")}),o+=e("Effective Attributes",p);const C={};let l=!1;h.each(m.BOON_DURATION,function(e,o){let t=r.attributes[o];t&&(l=!0,t+=r.attributes["Boon Duration"],C[o]=100<t?`100.00% (${t.toFixed(2)})`:`${t.toFixed(2)}`)}),h.each(m.CONDITION_DURATION,function(e,o){let t=r.attributes[o]||0;t&&(l=!0,t+=r.attributes["Condition Duration"],C[o]=100<t?`100.00% (${t.toFixed(2)})`:`${t.toFixed(2)}`)}),l&&(o+=e("Special Durations",C));const u={};return h.each(m.CONDITION_DAMAGE,function(e,o){u[o]=(r.attributes[o]||0).toFixed(2)}),o+=e("Condition Damage Ticks",u),o+="</div>",o+="</div>",o+="</div>",o+="</div>",o+="</div>",o+="</div>",o+="</div>",h(o)};h(l.DROPDOWN_SELECT).children(l.DROPDOWN_MENU).children(l.DROPDOWN_ITEM).on(Event.CLICK,function(e){h(this).hasClass(n.DISABLED)?e.stopPropagation():(h(this).siblings(l.DROPDOWN_ITEM).removeClass(n.ACTIVE),h(this).addClass(n.ACTIVE),h(this).parent().siblings(l.DROPDOWN_TOGGLE).html(h(this).html()))}),h("[data-"+E.PRIORITIES+"]").on(Event.CLICK,function(){"power-dps"===h(this).data(E.PRIORITIES)?(h("[id^=go-checkbox-affix-]").prop(c.CHECKED,!1),h(l.CHECKBOX.AFFIX.BERSERKER).prop(c.CHECKED,!0),h(l.CHECKBOX.AFFIX.ASSASSIN).prop(c.CHECKED,!0),h(l.INPUT.MIN_BOON_DURATION).val(0)):"power-boon"===h(this).data(E.PRIORITIES)?(h("[id^=go-checkbox-affix-]").prop(c.CHECKED,!1),h(l.CHECKBOX.AFFIX.BERSERKER).prop(c.CHECKED,!0),h(l.CHECKBOX.AFFIX.ASSASSIN).prop(c.CHECKED,!0),h(l.CHECKBOX.AFFIX.DIVINER).prop(c.CHECKED,!0),h(l.INPUT.MIN_BOON_DURATION).val(100)):"condi-dps"===h(this).data(E.PRIORITIES)?(h("[id^=go-checkbox-affix-]").prop(c.CHECKED,!1),h(l.CHECKBOX.AFFIX.VIPER).prop(c.CHECKED,!0),h(l.CHECKBOX.AFFIX.SINISTER).prop(c.CHECKED,!0),h(l.CHECKBOX.AFFIX.GRIEVING).prop(c.CHECKED,!0),h(l.INPUT.MIN_BOON_DURATION).val(0)):"heal"===h(this).data(E.PRIORITIES)?(h("[id^=go-checkbox-affix-]").prop(c.CHECKED,!1),h(l.CHECKBOX.AFFIX.HARRIER).prop(c.CHECKED,!0),h(l.CHECKBOX.AFFIX.MINSTREL).prop(c.CHECKED,!0),h(l.CHECKBOX.AFFIX.MAGI).prop(c.CHECKED,!0),h(l.INPUT.MIN_BOON_DURATION).val(100)):"condi-boon"===h(this).data(E.PRIORITIES)&&(h("[id^=go-checkbox-affix-]").prop(c.CHECKED,!1),h(l.CHECKBOX.AFFIX.VIPER).prop(c.CHECKED,!0),h(l.CHECKBOX.AFFIX.SERAPH).prop(c.CHECKED,!0),h(l.CHECKBOX.AFFIX.CELESTIAL).prop(c.CHECKED,!0),h(l.INPUT.MIN_BOON_DURATION).val(79))}),h("[data-"+E.PRESELECTION+"]").on(Event.CLICK,function(){"pchrono"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-mesmer-"]').prop(c.CHECKED,!1),h("#go-checkbox-mesmer-fragility").prop(c.CHECKED,!0),h("#go-checkbox-mesmer-egotism").prop(c.CHECKED,!0),h("#go-checkbox-mesmer-vicious-expression").prop(c.CHECKED,!0),h("#go-checkbox-mesmer-fencers-finesse").prop(c.CHECKED,!0),h("#go-checkbox-mesmer-superiority-complex").prop(c.CHECKED,!0)):"staffmirage"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-mesmer-"]').prop(c.CHECKED,!1),h("#go-checkbox-mesmer-signet-of-domination").prop(c.CHECKED,!0),h("#go-checkbox-mesmer-signet-of-midnight").prop(c.CHECKED,!0),h("#go-checkbox-mesmer-illusionary-membrane").prop(c.CHECKED,!0),h("#go-checkbox-mesmer-chaotic-potency").prop(c.CHECKED,!0),h("#go-checkbox-mesmer-chaotic-potency-2").prop(c.CHECKED,!0),h("#go-checkbox-mesmer-chaotic-persistence").prop(c.CHECKED,!0),h("#go-checkbox-mesmer-nomads-endurance").prop(c.CHECKED,!0)):"dh"===h(this).data(E.PRESELECTION)||"pqfb"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-guardian-"]').prop(c.CHECKED,!1),h("#go-checkbox-guardian-fiery-wrath").prop(c.CHECKED,!0),h("#go-checkbox-guardian-symbolic-avenger").prop(c.CHECKED,!0),h("#go-checkbox-guardian-symbolic-exposure").prop(c.CHECKED,!0),h("#go-checkbox-guardian-zealous-blade").prop(c.CHECKED,!0),h("#go-checkbox-guardian-retribution").prop(c.CHECKED,!0),h("#go-checkbox-guardian-radiant-power").prop(c.CHECKED,!0),"dh"===h(this).data(E.PRESELECTION)?(h("#go-checkbox-guardian-zealots-aggression").prop(c.CHECKED,!0),h("#go-checkbox-guardian-pure-of-sight").prop(c.CHECKED,!0),h("#go-checkbox-guardian-big-game-hunter").prop(c.CHECKED,!0)):h("#go-checkbox-guardian-imbued-haste").prop(c.CHECKED,!0)):"cfb"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-guardian-"]').prop(c.CHECKED,!1),h("#go-checkbox-guardian-signet-of-wrath").prop(c.CHECKED,!0),h("#go-checkbox-guardian-right-hand-strength").prop(c.CHECKED,!0),h("#go-checkbox-guardian-right-hand-strength-3").prop(c.CHECKED,!0),h("#go-checkbox-guardian-radiant-fire").prop(c.CHECKED,!0),h("#go-checkbox-guardian-radiant-power").prop(c.CHECKED,!0),h("#go-checkbox-guardian-amplified-wrath").prop(c.CHECKED,!0),h("#go-checkbox-guardian-inspired-virtue-9").prop(c.CHECKED,!0),h("#go-checkbox-guardian-virtue-of-retribution").prop(c.CHECKED,!0),h("#go-checkbox-guardian-power-of-the-virtuous").prop(c.CHECKED,!0),h("#go-checkbox-guardian-imbued-haste").prop(c.CHECKED,!0)):"cfb2"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-guardian-"]').prop(c.CHECKED,!1),h("#go-checkbox-guardian-signet-of-wrath").prop(c.CHECKED,!0),h("#go-checkbox-guardian-fiery-wrath").prop(c.CHECKED,!0),h("#go-checkbox-guardian-symbolic-exposure").prop(c.CHECKED,!0),h("#go-checkbox-guardian-kindled-zeal").prop(c.CHECKED,!0),h("#go-checkbox-guardian-right-hand-strength").prop(c.CHECKED,!0),h("#go-checkbox-guardian-right-hand-strength-3").prop(c.CHECKED,!0),h("#go-checkbox-guardian-radiant-fire").prop(c.CHECKED,!0),h("#go-checkbox-guardian-radiant-power").prop(c.CHECKED,!0),h("#go-checkbox-guardian-amplified-wrath").prop(c.CHECKED,!0),h("#go-checkbox-guardian-imbued-haste").prop(c.CHECKED,!0)):"pbers"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-warrior-"]').prop(c.CHECKED,!1),h("#go-checkbox-warrior-peak-performance").prop(c.CHECKED,!0),h("#go-checkbox-warrior-signet-of-might").prop(c.CHECKED,!0),h("#go-checkbox-warrior-great-fortitude").prop(c.CHECKED,!0),h("#go-checkbox-warrior-pinnacle-of-strength").prop(c.CHECKED,!0),h("#go-checkbox-warrior-berserkers-power").prop(c.CHECKED,!0),h("#go-checkbox-warrior-warriors-sprint").prop(c.CHECKED,!0),h("#go-checkbox-warrior-double-standards").prop(c.CHECKED,!0),h("#go-checkbox-warrior-axe-mastery-one").prop(c.CHECKED,!0),h("#go-checkbox-warrior-axe-mastery-two").prop(c.CHECKED,!0),h("#go-checkbox-warrior-blood-reaction-with").prop(c.CHECKED,!0),h("#go-checkbox-warrior-fatal-frenzy").prop(c.CHECKED,!0),h("#go-checkbox-warrior-bloody-roar").prop(c.CHECKED,!0)):"cbers"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-warrior-"]').prop(c.CHECKED,!1),h("#go-checkbox-warrior-wounding-precision").prop(c.CHECKED,!0),h("#go-checkbox-warrior-deep-strikes").prop(c.CHECKED,!0),h("#go-checkbox-warrior-blade-master").prop(c.CHECKED,!0),h("#go-checkbox-warrior-blade-master-2").prop(c.CHECKED,!0),h("#go-checkbox-warrior-bloodlust").prop(c.CHECKED,!0),h("#go-checkbox-warrior-furious").prop(c.CHECKED,!0),h("#go-checkbox-warrior-double-standards").prop(c.CHECKED,!0),h("#go-checkbox-warrior-heat-the-soul").prop(c.CHECKED,!0),h("#go-checkbox-warrior-heat-the-soul-with").prop(c.CHECKED,!0),h("#go-checkbox-warrior-fatal-frenzy").prop(c.CHECKED,!0),h("#go-checkbox-warrior-king-of-fires").prop(c.CHECKED,!0)):"pwea"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-elementalist-"]').prop(c.CHECKED,!1),h("#go-checkbox-elementalist-empowering-flame").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-burning-precision").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-power-overwhelming").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-power-overwhelming-2").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-pyromancers-training").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-ferocious-winds").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-stormsoul").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-aeromancers-training").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-bolt-to-the-heart").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-masters-fortitude").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-elements-of-rage").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-swift-revenge").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-elemental-polyphony-fire").prop(c.CHECKED,!0)):"cwea"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-elementalist-"]').prop(c.CHECKED,!1),h("#go-checkbox-elementalist-empowering-flame").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-burning-precision").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-burning-rage").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-pyromancers-training").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-stone-flesh").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-serrated-stones").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-strength-of-stone").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-geomancers-defense").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-superior-elements").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-weavers-prowess").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-elemental-polyphony-fire").prop(c.CHECKED,!0),h("#go-checkbox-elementalist-elements-of-rage").prop(c.CHECKED,!0)):"pslb"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-ranger-"]').prop(c.CHECKED,!1),h("#go-checkbox-ranger-farsighted").prop(c.CHECKED,!0),h("#go-checkbox-ranger-predators-onslaught").prop(c.CHECKED,!0),h("#go-checkbox-ranger-honed-axes").prop(c.CHECKED,!0),h("#go-checkbox-ranger-honed-axes-2").prop(c.CHECKED,!0),h("#go-checkbox-ranger-furious-strength").prop(c.CHECKED,!0),h("#go-checkbox-ranger-twice-as-vicious").prop(c.CHECKED,!0),h("#go-checkbox-ranger-signet-of-the-wild").prop(c.CHECKED,!0),h("#go-checkbox-ranger-archetype-ferocious").prop(c.CHECKED,!0),h("#go-checkbox-ranger-sb-1").prop(c.CHECKED,!0),h("#go-checkbox-ranger-sb-2").prop(c.CHECKED,!0),h("#go-checkbox-ranger-sb-3").prop(c.CHECKED,!0),h("#go-checkbox-ranger-sb-4").prop(c.CHECKED,!0)):"cslb"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-ranger-"]').prop(c.CHECKED,!1),h("#go-checkbox-ranger-hidden-barbs").prop(c.CHECKED,!0),h("#go-checkbox-ranger-hunters-tactics").prop(c.CHECKED,!0),h("#go-checkbox-ranger-light-on-your-feet").prop(c.CHECKED,!0),h("#go-checkbox-ranger-taste-for-danger").prop(c.CHECKED,!0),h("#go-checkbox-ranger-ambidexterity").prop(c.CHECKED,!0),h("#go-checkbox-ranger-ambidexterity-2").prop(c.CHECKED,!0),h("#go-checkbox-ranger-poison-master").prop(c.CHECKED,!0),h("#go-checkbox-ranger-furious-strength").prop(c.CHECKED,!0),h("#go-checkbox-ranger-twice-as-vicious").prop(c.CHECKED,!0),h("#go-checkbox-ranger-archetype-deadly").prop(c.CHECKED,!0)):"cslb2"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-ranger-"]').prop(c.CHECKED,!1),h("#go-checkbox-ranger-hidden-barbs").prop(c.CHECKED,!0),h("#go-checkbox-ranger-hunters-tactics").prop(c.CHECKED,!0),h("#go-checkbox-ranger-taste-for-danger").prop(c.CHECKED,!0),h("#go-checkbox-ranger-ambidexterity").prop(c.CHECKED,!0),h("#go-checkbox-ranger-ambidexterity-2").prop(c.CHECKED,!0),h("#go-checkbox-ranger-poison-master").prop(c.CHECKED,!0),h("#go-checkbox-ranger-furious-strength").prop(c.CHECKED,!0),h("#go-checkbox-ranger-twice-as-vicious").prop(c.CHECKED,!0),h("#go-checkbox-ranger-archetype-deadly").prop(c.CHECKED,!0)):"hslb"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-ranger-"]').prop(c.CHECKED,!1),h("#go-checkbox-ranger-hidden-barbs").prop(c.CHECKED,!0),h("#go-checkbox-ranger-hunters-tactics").prop(c.CHECKED,!0),h("#go-checkbox-ranger-vicious-quarry").prop(c.CHECKED,!0),h("#go-checkbox-ranger-honed-axes").prop(c.CHECKED,!0),h("#go-checkbox-ranger-honed-axes-3").prop(c.CHECKED,!0),h("#go-checkbox-ranger-furious-strength").prop(c.CHECKED,!0),h("#go-checkbox-ranger-twice-as-vicious").prop(c.CHECKED,!0),h("#go-checkbox-ranger-archetype-deadly").prop(c.CHECKED,!0),h("#go-checkbox-ranger-sb-1").prop(c.CHECKED,!0),h("#go-checkbox-ranger-sb-2").prop(c.CHECKED,!0),h("#go-checkbox-ranger-sb-3").prop(c.CHECKED,!0),h("#go-checkbox-ranger-sb-4").prop(c.CHECKED,!0)):"pren"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-rev-"]').prop(c.CHECKED,!1),h("#go-checkbox-rev-53").prop(c.CHECKED,!0),h("#go-checkbox-rev-13").prop(c.CHECKED,!0),h("#go-checkbox-rev-4").prop(c.CHECKED,!0),h("#go-checkbox-rev-5").prop(c.CHECKED,!0),h("#go-checkbox-rev-6").prop(c.CHECKED,!0),h("#go-checkbox-rev-7").prop(c.CHECKED,!0),h("#go-checkbox-rev-8").prop(c.CHECKED,!0),h("#go-checkbox-rev-11").prop(c.CHECKED,!0)):"cren-deva"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-rev-"]').prop(c.CHECKED,!1),h("#go-checkbox-rev-1").prop(c.CHECKED,!0),h("#go-checkbox-rev-seething-malice").prop(c.CHECKED,!0),h("#go-checkbox-rev-pact-of-pain").prop(c.CHECKED,!0),h("#go-checkbox-rev-2").prop(c.CHECKED,!0),h("#go-checkbox-rev-4").prop(c.CHECKED,!0),h("#go-checkbox-rev-destructive-impulses-3").prop(c.CHECKED,!0),h("#go-checkbox-rev-6").prop(c.CHECKED,!0),h("#go-checkbox-rev-8").prop(c.CHECKED,!0),h("#go-checkbox-rev-9").prop(c.CHECKED,!0),h("#go-checkbox-rev-10").prop(c.CHECKED,!0),h("#go-checkbox-rev-11").prop(c.CHECKED,!0),h("#go-checkbox-rev-12").prop(c.CHECKED,!0)):"pholo"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-engy-"]').prop(c.CHECKED,!1),h("#go-checkbox-engy-glass-cannon").prop(c.CHECKED,!0),h("#go-checkbox-engy-explosive-temper").prop(c.CHECKED,!0),h("#go-checkbox-engy-shaped-charge").prop(c.CHECKED,!0),h("#go-checkbox-engy-big-boomer").prop(c.CHECKED,!0),h("#go-checkbox-engy-high-caliber").prop(c.CHECKED,!0),h("#go-checkbox-engy-hematic-focus").prop(c.CHECKED,!0),h("#go-checkbox-engy-no-scope").prop(c.CHECKED,!0),h("#go-checkbox-engy-serrated-steel").prop(c.CHECKED,!0),h("#go-checkbox-engy-modified-ammunition-10").prop(c.CHECKED,!0)):"pscrap"===h(this).data(E.PRESELECTION)?(h('[id^="go-checkbox-engy-"]').prop(c.CHECKED,!1),h("#go-checkbox-engy-glass-cannon").prop(c.CHECKED,!0),h("#go-checkbox-engy-explosive-temper").prop(c.CHECKED,!0),h("#go-checkbox-engy-shaped-charge").prop(c.CHECKED,!0),h("#go-checkbox-engy-big-boomer").prop(c.CHECKED,!0),h("#go-checkbox-engy-high-caliber").prop(c.CHECKED,!0),h("#go-checkbox-engy-hematic-focus").prop(c.CHECKED,!0),h("#go-checkbox-engy-no-scope").prop(c.CHECKED,!0),h("#go-checkbox-engy-serrated-steel").prop(c.CHECKED,!0),h("#go-checkbox-engy-modified-ammunition-10").prop(c.CHECKED,!0),h("#go-checkbox-engy-object-in-motion-2").prop(c.CHECKED,!0),h("#go-checkbox-engy-impact-savant").prop(c.CHECKED,!0),h("#go-checkbox-engy-applied-force").prop(c.CHECKED,!0)):"cholo"===h(this).data(E.PRESELECTION)&&(h('[id^="go-checkbox-engy-"]').prop(c.CHECKED,!1),h("#go-checkbox-engy-glass-cannon").prop(c.CHECKED,!0),h("#go-checkbox-engy-explosive-temper").prop(c.CHECKED,!0),h("#go-checkbox-engy-shaped-charge").prop(c.CHECKED,!0),h("#go-checkbox-engy-chemical-rounds").prop(c.CHECKED,!0),h("#go-checkbox-engy-hematic-focus").prop(c.CHECKED,!0),h("#go-checkbox-engy-thermal-vision").prop(c.CHECKED,!0),h("#go-checkbox-engy-serrated-steel").prop(c.CHECKED,!0),h("#go-checkbox-engy-incendiary-powder").prop(c.CHECKED,!0))}),h("[data-"+E.BUFFS+"]").on(Event.CLICK,function(){"none"===h(this).data(E.BUFFS)?h(l.INPUT.BUFFS).find(l.CHECKBOXES).prop(c.CHECKED,!1):"fractal"===h(this).data(E.BUFFS)?(h(l.INPUT.BUFFS).find(l.CHECKBOXES).prop(c.CHECKED,!1),h(l.CHECKBOX.BUFF.MIGHT).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.FURY).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.VULNERABILITY).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.BANNER_OF_STRENGTH).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.BANNER_OF_DISCIPLINE).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.EMPOWER_ALLIES).prop(c.CHECKED,!1),h(l.CHECKBOX.BUFF.SPOTTER).prop(c.CHECKED,!1),h(l.CHECKBOX.BUFF.BANE_SIGNET).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.FROST_SPIRIT).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.ASSASSINS_PRESENCE).prop(c.CHECKED,!0)):"benchmark"===h(this).data(E.BUFFS)?(h(l.INPUT.BUFFS).find(l.CHECKBOXES).prop(c.CHECKED,!1),h(l.CHECKBOX.BUFF.MIGHT).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.FURY).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.VULNERABILITY).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.BANNER_OF_STRENGTH).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.BANNER_OF_DISCIPLINE).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.EMPOWER_ALLIES).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.SPOTTER).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.BANE_SIGNET).prop(c.CHECKED,!1),h(l.CHECKBOX.BUFF.FROST_SPIRIT).prop(c.CHECKED,!0),h(l.CHECKBOX.BUFF.ASSASSINS_PRESENCE).prop(c.CHECKED,!1)):"all"===h(this).data(E.BUFFS)&&h(l.INPUT.BUFFS).find(l.CHECKBOXES).prop(c.CHECKED,!0)}),h("[data-"+E.DISTRIBUTION+"]").on(Event.CLICK,function(){switch(h(this).data(E.DISTRIBUTION)){case"power":h("#go-condition-distribution-slider")[0].noUiSlider.set([100,100,100,100,100]);break;case"cwarr":h("#go-condition-distribution-slider")[0].noUiSlider.set([27,81,96,99,100]);break;case"cfb":h("#go-condition-distribution-slider")[0].noUiSlider.set([31,96,99,99,100]);break;case"cfb2":h("#go-condition-distribution-slider")[0].noUiSlider.set([24,96,99,99,100]);break;case"cweasw":h("#go-condition-distribution-slider")[0].noUiSlider.set([36,89,100,100,100]);break;case"cweadagg":h("#go-condition-distribution-slider")[0].noUiSlider.set([29,84,100,100,100]);break;case"cren-deva":h("#go-condition-distribution-slider")[0].noUiSlider.set([44,64,75,80,100]);break;case"cren-invo":h("#go-condition-distribution-slider")[0].noUiSlider.set([42,64,75,80,100]);break;case"cslb":h("#go-condition-distribution-slider")[0].noUiSlider.set([30,45,75,100,100]);break;case"cslb2":h("#go-condition-distribution-slider")[0].noUiSlider.set([30,52,78,100,100]);break;case"hslb":h("#go-condition-distribution-slider")[0].noUiSlider.set([43,61,89,100,100]);break;case"cholo":h("#go-condition-distribution-slider")[0].noUiSlider.set([31,77,86,95,95])}}),h(l.START).on(Event.CLICK,function(){(new t).calculate()}),h(l.STOP).on(Event.CLICK,function(){u=!0}),h(l.OUTPUT.LIST).on(Event.CLICK,"tr",function(){r(h(this).data("character")).modal("show"),h.getScript("https://unpkg.com/armory-embeds/armory-embeds.js")}),h("#gear-optimizer").find("> .card-nav > .nav-tabs").on("shown.bs.tab","a.nav-link",function(){h("#go-input-class").siblings().removeClass("d-none")}),noUiSlider.create(h("#go-condition-distribution-slider")[0],{range:{min:[0],max:[100]},start:[100,100,100,100,100],connect:[!0,!0,!0,!0,!0,!0],step:1,pips:{mode:"values",values:[0,10,20,30,40,50,60,70,80,90,100],density:1}});for(let e=0;e<6;e++)h("#go-condition-distribution-slider")[0].querySelectorAll(".noUi-connect")[e].classList.add("slider-bar-"+e);return h("#go-condition-distribution-slider")[0].noUiSlider.on("update",function(e,o){switch(o){case 0:h("#go-input-power-percentage").val(parseInt(e[0])),h("#go-input-burning-percentage").val(e[1]-e[0]);break;case 1:h("#go-input-burning-percentage").val(e[1]-e[0]),h("#go-input-bleeding-percentage").val(e[2]-e[1]);break;case 2:h("#go-input-bleeding-percentage").val(e[2]-e[1]),h("#go-input-poison-percentage").val(e[3]-e[2]);break;case 3:h("#go-input-poison-percentage").val(e[3]-e[2]),h("#go-input-torment-percentage").val(e[4]-e[3]);break;case 4:h("#go-input-torment-percentage").val(e[4]-e[3]),h("#go-input-confusion-percentage").val(100-e[4])}}),h(function(){h('[data-toggle="tooltip"]').tooltip()}),h("#debug-additive").click(function(){h(".debug-legend").length?h("#debug-legend").empty():h("#go-input-class .card-body").prepend(h('<div class="debug-legend"></div>')),h(".debug-legend").html(`
      Damage bonus stacks:
      <span style="color: green">multiplicatively (normal)</span> ///
      <span style="color: blue">additively with other additive mods</span>
    `),h("#go-input-class .input").css("color","inherit"),h("#go-input-class .input").each((e,o)=>{const t=h(o).find("input").attr("data-go-modifier");t&&(t.includes("add: ")&&h(o).css("color","blue"),t.includes('"Effective Power')&&h(o).css("color","green"),t.includes('"Effective Condition Damage')&&h(o).css("color","green"),t.includes("add: ")&&(t.includes('"Effective Power')||t.includes('"Effective Condition Damage'))&&h(o).css("color","purple"))})}),h("#debug-converted").click(function(){h(".debug-legend").length?h("#debug-legend").empty():h("#go-input-class .card-body").prepend(h('<div class="debug-legend"></div>')),h(".debug-legend").html(`
      Added buff stats will be:
      <span style="color: yellow">converted by e.g. sharpening stones</span> ///
      <span style="color: orange">not converted by e.g. sharpening stones</span>
    `),h("#go-input-class .input").css("color","inherit"),h("#go-input-class .input").each((e,o)=>{const t=h(o).find("input").attr("data-go-modifier");t&&(t.includes("flat")&&h(o).css("color","yellow"),t.includes("buff")&&h(o).css("color","orange"),t.includes("flat")&&t.includes("buff")&&h(o).css("color","purple"))})}),t}(jQuery);